{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Scene/UILoadingScene.ts"],"names":["_decorator","Component","director","ProgressBar","resources","AudioClip","SCENE_ENUM","ccclass","property","LoadingManager","onLoad","preLoad","preloadScene","BATTLE","preloadDir","cur","total","bar","progress","err","Promise","rs","setTimeout","loadSoundRes","loadScene","console","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,S,OAAAA,S;;AACzDC,MAAAA,U,iBAAAA,U;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;gCAGjBS,c,WADZF,OAAO,CAAC,gBAAD,C,UAEHC,QAAQ,CAACL,WAAD,C,2BAFb,MACaM,cADb,SACoCR,SADpC,CAC8C;AAAA;AAAA;;AAAA;AAAA;;AAI1CS,QAAAA,MAAM,GAAG,CACL;AACH;;AACDC,QAAAA,OAAO,GAAG;AAAA;;AACNT,UAAAA,QAAQ,CAACU,YAAT,CAAsB;AAAA;AAAA,wCAAWC,MAAjC;AACAT,UAAAA,SAAS,CAACU,UAAV,CACI,SADJ,EAEI,CAACC,GAAD,EAAMC,KAAN,KAAgB;AACZ,iBAAKC,GAAL,CAASC,QAAT,GAAoBH,GAAG,GAAGC,KAA1B;AACH,WAJL,iCAKI,WAAMG,GAAN,EAAa;AACT,gBAAIA,GAAJ,EAAS;AACL,oBAAM,IAAIC,OAAJ,CAAYC,EAAE,IAAI;AACpBC,gBAAAA,UAAU,CAACD,EAAD,EAAK,IAAL,CAAV;AACH,eAFK,CAAN;;AAGA,cAAA,KAAI,CAACV,OAAL;;AACA;AACH;;AACD,kBAAM,KAAI,CAACY,YAAL,EAAN;AACArB,YAAAA,QAAQ,CAACsB,SAAT,CAAmB;AAAA;AAAA,0CAAWX,MAA9B;AACH,WAfL;AAiBH;;AAEKU,QAAAA,YAAY,GAAG;AAAA;AACjB,mBAAO,IAAIH,OAAJ,CAAaC,EAAD,IAAQ;AACvBjB,cAAAA,SAAS,CAACU,UAAV,CAAqB,OAArB,EAA8BT,SAA9B,EAAyC,MAAM;AAC3CoB,gBAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAL,gBAAAA,EAAE,CAAC,IAAD,CAAF;AACH,eAHD;AAIH,aALM,CAAP;AADiB;AAOpB;;AAnCyC,O","sourcesContent":["import { _decorator, Component, director, ProgressBar, resources, AudioClip } from 'cc'\nimport { SCENE_ENUM } from '../../Enum'\nconst { ccclass, property } = _decorator\n\n@ccclass('LoadingManager')\nexport class LoadingManager extends Component {\n    @property(ProgressBar)\n    bar: ProgressBar\n\n    onLoad() {\n        // this.preLoad()\n    }\n    preLoad() {\n        director.preloadScene(SCENE_ENUM.BATTLE)\n        resources.preloadDir(\n            'texture',\n            (cur, total) => {\n                this.bar.progress = cur / total\n            },\n            async err => {\n                if (err) {\n                    await new Promise(rs => {\n                        setTimeout(rs, 1000)\n                    })\n                    this.preLoad()\n                    return\n                }\n                await this.loadSoundRes()\n                director.loadScene(SCENE_ENUM.BATTLE)\n            },\n        )\n    }\n\n    async loadSoundRes() {\n        return new Promise((rs) => {\n            resources.preloadDir('sound', AudioClip, () => {\n                console.log('音频资源预加载完成')\n                rs(null)\n            })\n        })\n    }\n}"]}