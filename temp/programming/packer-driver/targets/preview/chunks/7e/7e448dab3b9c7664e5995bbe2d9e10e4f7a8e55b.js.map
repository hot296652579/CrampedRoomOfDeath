{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/TileMap/TileMapManager.ts"],"names":["Component","_decorator","Node","resources","SpriteFrame","Sprite","UITransform","Layers","levels","TILE_WIDTH","TILE_HEIGHT","ccclass","property","TileMapManager","start","init","spriteFrames","loadRes","console","log","mapInfo","index","length","colnum","j","item","src","type","node","sprite","addComponent","imgSrc","spriteFrame","find","v","name","transfrom","setContentSize","layer","nameToLayer","setPosition","setParent","Promise","resolve","reject","loadDir","err","assets"],"mappings":"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","sourcesContent":["import { Component, _decorator, Node, resources, SpriteFrame, Sprite, UITransform, Layers } from \"cc\";\nimport levels from \"../../Levels\";\n\nconst TILE_WIDTH = 55\nconst TILE_HEIGHT = 55\n\nconst { ccclass, property } = _decorator;\n@ccclass('TileMapManager')\nexport class TileMapManager extends Component {\n    start() {\n\n    }\n\n    async init() {\n        const spriteFrames = await this.loadRes()\n        console.log(spriteFrames)\n        const { mapInfo } = levels[`level${1}`]\n\n        for (let index = 0; index < mapInfo.length; index++) {\n            const colnum = mapInfo[index];\n            for (let j = 0; j < colnum.length; j++) {\n                const item = colnum[j];\n                if (item.src === null || item.type === null)\n                    continue\n\n                const node = new Node()\n                const sprite = node.addComponent(Sprite)\n                console.log(item.src)\n                const imgSrc = `tile (${item.src})`\n                sprite.spriteFrame = spriteFrames.find(v => v.name === imgSrc) || spriteFrames[0]\n\n                const transfrom = node.addComponent(UITransform)\n                transfrom.setContentSize(TILE_WIDTH, TILE_HEIGHT)\n\n                node.layer = 1 << Layers.nameToLayer('UI_2D')\n                node.setPosition(index * TILE_WIDTH, -j * TILE_HEIGHT)\n                node.setParent(this.node)\n            }\n        }\n    }\n\n    loadRes() {\n        return new Promise<SpriteFrame[]>((resolve, reject) => {\n            resources.loadDir(\"texture/tile/tile\", SpriteFrame, function (err, assets) {\n                if (!err) {\n                    resolve(assets)\n                } else {\n                    console.log(err)\n                    reject(false)\n                }\n            });\n        })\n    }\n}"]}