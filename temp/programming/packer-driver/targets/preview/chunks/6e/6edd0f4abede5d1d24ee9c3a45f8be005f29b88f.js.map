{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Enemy/Wooden/WoodenMgr.ts"],"names":["_decorator","ENTITY_STATE_ENUM","ENUM_EVENT","EnemyMgr","EventMgr","DataManager","WoodenStateMachine","MOVE_SPEED","ccclass","property","WoodenMgr","init","params","fsm","addComponent","checkAttack","console","log","state","DEATH","Instance","playerInfo","x","playerX","y","playerY","playerState","disX","Math","abs","disY","AIRDEATH","ATTACK","emit","ENUM_PLAYER_DEATH","IDLE","onLoad","addEventListen","ENUM_MOVE_END","onDestry","unEventListen"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACoBA,MAAAA,U,OAAAA,U;;AAC6CC,MAAAA,iB,iBAAAA,iB;AAAmBC,MAAAA,U,iBAAAA,U;;AAE3EC,MAAAA,Q,iBAAAA,Q;;AAEFC,MAAAA,Q;;AAEAC,MAAAA,W;;AACEC,MAAAA,kB,iBAAAA,kB;;;;;;;;;4BAEIC,U,GAAa,IAAI,E;;OAExB;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;2BAEjBU,S,WADZF,OAAO,CAAC,WAAD,C,gBAAR,MACaE,SADb;AAAA;AAAA,gCACwC;AAE9BC,QAAAA,IAAI,CAACC,MAAD,EAAkB;AAAA;AAAA;;AAAA;AACxB,YAAA,KAAI,CAACC,GAAL,GAAW,KAAI,CAACC,YAAL;AAAA;AAAA,yDAAX;AACA,kBAAM,KAAI,CAACD,GAAL,CAASF,IAAT,EAAN;;AACA,6CAAWC,MAAX;AAHwB;AAI3B;;AAEDG,QAAAA,WAAW,GAAG;AACVC,UAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0B,KAAKC,KAA/B;AACA,cAAI,KAAKA,KAAL,KAAe;AAAA;AAAA,sDAAkBC,KAAjC,IAA0C,CAAC;AAAA;AAAA,0CAAYC,QAAZ,CAAqBC,UAApE,EACI;AAEJ,cAAM;AAAEC,YAAAA,CAAC,EAAEC,OAAL;AAAcC,YAAAA,CAAC,EAAEC,OAAjB;AAA0BP,YAAAA,KAAK,EAAEQ;AAAjC,cAAiD;AAAA;AAAA,0CAAYN,QAAZ,CAAqBC,UAA5E;AACA,cAAMM,IAAI,GAAGC,IAAI,CAACC,GAAL,CAAS,KAAKP,CAAL,GAASC,OAAlB,CAAb;AACA,cAAMO,IAAI,GAAGF,IAAI,CAACC,GAAL,CAAS,KAAKL,CAAL,GAASC,OAAlB,CAAb;AAEA,cAAIC,WAAW,IAAI;AAAA;AAAA,sDAAkBP,KAAjC,IAA0CO,WAAW,IAAI;AAAA;AAAA,sDAAkBK,QAA/E,EACI;;AAEJ,cAAK,KAAKT,CAAL,KAAWC,OAAX,IAAsBO,IAAI,IAAI,CAA/B,IAAsC,KAAKN,CAAL,KAAWC,OAAX,IAAsBE,IAAI,IAAI,CAAxE,EAA4E;AACxE,iBAAKT,KAAL,GAAa;AAAA;AAAA,wDAAkBc,MAA/B;AACA;AAAA;AAAA,sCAASZ,QAAT,CAAkBa,IAAlB,CAAuB;AAAA;AAAA,0CAAWC,iBAAlC,EAAqD;AAAA;AAAA,wDAAkBf,KAAvE;AACH,WAHD,MAGO;AACH,iBAAKD,KAAL,GAAa;AAAA;AAAA,wDAAkBiB,IAA/B;AACH;AACJ;;AAEDC,QAAAA,MAAM,GAAG;AACL,gBAAMA,MAAN;AACA;AAAA;AAAA,oCAAShB,QAAT,CAAkBiB,cAAlB,CAAiC;AAAA;AAAA,wCAAWC,aAA5C,EAA2D,KAAKvB,WAAhE,EAA6E,IAA7E;AACH;;AAEDwB,QAAAA,QAAQ,GAAG;AACP,gBAAMA,QAAN;AACA;AAAA;AAAA,oCAASnB,QAAT,CAAkBoB,aAAlB,CAAgC;AAAA;AAAA,wCAAWF,aAA3C,EAA0D,KAAKvB,WAA/D;AACH;;AApCmC,O","sourcesContent":["/**木骷髅管理器 */\nimport { Component, _decorator, Node, Sprite, UITransform, Animation, SpriteAtlas, AnimationClip, animation, SpriteFrame, Texture2D, math } from \"cc\";\nimport { DIRECTION_ENUM, DIRECTION_ORDER_ENUM, ENITIY_TYPE_ENUM, ENTITY_STATE_ENUM, ENUM_EVENT, ENUM_BOTTOM_CONTROLLER, PARAMS_NAME_TYPE } from \"../../../Enum\";\nimport { IEnitiy } from \"../../../Levels\";\nimport { EnemyMgr } from \"../../Base/EnemyMgr\";\nimport { EnitiyMgr } from \"../../Base/EnitiyMgr\";\nimport EventMgr from \"../../Base/EventMgr\";\nimport { PlayerStateMachine } from \"../../Player/PlayerStateMachine\";\nimport DataManager from \"../../Runtime/DataManager\";\nimport { WoodenStateMachine } from \"./WoodenStateMachine\";\n\nexport const MOVE_SPEED = 1 / 10\n\nconst { ccclass, property } = _decorator;\n@ccclass('WoodenMgr')\nexport class WoodenMgr extends EnemyMgr {\n\n    async init(params: IEnitiy) {\n        this.fsm = this.addComponent(WoodenStateMachine)\n        await this.fsm.init()\n        super.init(params)\n    }\n\n    checkAttack() {\n        console.log('this.state', this.state)\n        if (this.state === ENTITY_STATE_ENUM.DEATH || !DataManager.Instance.playerInfo)\n            return\n\n        const { x: playerX, y: playerY, state: playerState } = DataManager.Instance.playerInfo\n        const disX = Math.abs(this.x - playerX)\n        const disY = Math.abs(this.y - playerY)\n\n        if (playerState == ENTITY_STATE_ENUM.DEATH || playerState == ENTITY_STATE_ENUM.AIRDEATH)\n            return\n\n        if ((this.x === playerX && disY <= 1) || (this.y === playerY && disX <= 1)) {\n            this.state = ENTITY_STATE_ENUM.ATTACK\n            EventMgr.Instance.emit(ENUM_EVENT.ENUM_PLAYER_DEATH, ENTITY_STATE_ENUM.DEATH)\n        } else {\n            this.state = ENTITY_STATE_ENUM.IDLE\n        }\n    }\n\n    onLoad() {\n        super.onLoad()\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_MOVE_END, this.checkAttack, this)\n    }\n\n    onDestry() {\n        super.onDestry()\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_MOVE_END, this.checkAttack)\n    }\n\n\n}"]}