{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Player/PlayerMgr.ts"],"names":["_decorator","DIRECTION_ENUM","ENTITY_STATE_ENUM","ENUM_EVENT","ENUM_BOTTOM_CONTROLLER","EventMgr","DataManager","PlayerStateMachine","EnitiyMgr","MOVE_SPEED","ccclass","property","PlayerMrg","tartgetX","tartgetY","isMoving","init","params","fsm","addComponent","x","y","onLoad","Instance","addEventListen","ENUM_MOVE_PLAYER","inputHanlder","ENUM_PLAYER_DEATH","onDeathHanlder","onDestry","unEventListen","update","updateXY","Math","abs","emit","ENUM_MOVE_END","inputDirection","state","DEATH","AIRDEATH","ATTACK","willBlock","handlerMove","type","direction","tileMgrInfo","mapColumCount","mapRowCount","doorX","doorY","doorState","doorInfo","enemies","filter","enemy","console","log","TOP","playerNextY","playerNextX","BLOCKFRONT","weaponNextY","nextPlayerTile","nextWeaponTile","canMove","canTurn","i","length","enemyX","enemyY","BOTTOM","BLOCKBACK","LEFT","BLOCKRIGHT","weaponNextX","BLOCKLEFT","RIGHT","checkDoor","checkCollisionDoor","checkEnemy","checkCollisionEnenies","TURNLEFT","nextY","nextX","BLOCKTURNLEFT","TURNRIGHT","BLOCKTURNRIGHT","willAttack","index","id"],"mappings":"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","sourcesContent":["import { Component, _decorator, Node, Sprite, UITransform, Animation, SpriteAtlas, AnimationClip, animation, SpriteFrame, Texture2D, math } from \"cc\";\nimport { DIRECTION_ENUM, DIRECTION_ORDER_ENUM, ENITIY_TYPE_ENUM, ENTITY_STATE_ENUM, ENUM_EVENT, ENUM_BOTTOM_CONTROLLER, PARAMS_NAME_TYPE } from \"../../Enum\";\nimport levels, { IEnitiy, ILevel } from \"../../Levels\";\nimport EventMgr from \"../Base/EventMgr\";\nimport ResourceLoadMgr from \"../Base/ResourceLoadMgr\";\nimport DataManager from \"../Runtime/DataManager\";\nimport { TILE_HEIGHT, TILE_WIDTH } from \"../TileMap/TileManager\";\n// import { DataManager.Instance } from \"../Runtime/DataManager\";\nimport { TileMapManager } from \"../TileMap/TileMapManager\";\nimport { createNewNode } from \"../Utils\";\nimport { PlayerStateMachine } from \"./PlayerStateMachine\";\nimport { EnitiyMgr } from \"../Base/EnitiyMgr\";\nimport { EnemyMgr } from \"../Base/EnemyMgr\";\n\nexport const MOVE_SPEED = 1 / 10\n\nconst { ccclass, property } = _decorator;\n@ccclass('PlayerMrg')\nexport class PlayerMrg extends EnitiyMgr {\n\n    tartgetX: number = 0\n    tartgetY: number = 0\n    isMoving: boolean = false\n\n    async init(params: IEnitiy) {\n        this.fsm = this.addComponent(PlayerStateMachine)\n        await this.fsm.init()\n\n        super.init(params)\n\n        this.tartgetX = this.x\n        this.tartgetY = this.y\n    }\n\n    onLoad() {\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_MOVE_PLAYER, this.inputHanlder, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_PLAYER_DEATH, this.onDeathHanlder, this)\n    }\n\n    onDestry() {\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_MOVE_PLAYER, this.inputHanlder)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_PLAYER_DEATH, this.onDeathHanlder)\n    }\n\n    update() {\n        this.updateXY()\n        super.update()\n    }\n\n    updateXY() {\n        if (this.tartgetX < this.x) {\n            this.x -= MOVE_SPEED\n        } else if (this.tartgetX > this.x) {\n            this.x += MOVE_SPEED\n        } else if (this.tartgetY < this.y) {\n            this.y -= MOVE_SPEED\n        } else if (this.tartgetY > this.y) {\n            this.y += MOVE_SPEED\n        }\n\n        if (Math.abs(this.tartgetX - this.x) <= 0.1 && Math.abs(this.tartgetY - this.y) <= 0.1 && this.isMoving) {\n            this.isMoving = false\n            this.x = this.tartgetX\n            this.y = this.tartgetY\n\n            EventMgr.Instance.emit(ENUM_EVENT.ENUM_MOVE_END)\n        }\n    }\n\n    inputHanlder(inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        if (this.state === ENTITY_STATE_ENUM.DEATH || this.state === ENTITY_STATE_ENUM.AIRDEATH || this.state === ENTITY_STATE_ENUM.ATTACK)\n            return\n\n        if (this.isMoving)\n            return\n\n        if (this.willBlock(inputDirection)) {\n            return\n        }\n\n        // const enemyId = this.willAttack(inputDirection)\n        // if (enemyId) {\n        //     EventMgr.Instance.emit(ENUM_EVENT.ENUM_ENEMY_DEATH, enemyId)\n        //     EventMgr.Instance.emit(ENUM_EVENT.ENUM_OPEN_DOOR)\n        //     return\n        // }\n\n        this.handlerMove(inputDirection)\n    }\n\n    onDeathHanlder(type: ENTITY_STATE_ENUM) {\n        this.state = type\n    }\n\n    willBlock(inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        const { tartgetX: x, tartgetY: y, direction } = this\n        const { tileMgrInfo, mapColumCount, mapRowCount } = DataManager.Instance\n        const { x: doorX, y: doorY, state: doorState } = DataManager.Instance.doorInfo\n        const enemies: EnemyMgr[] = DataManager.Instance.enemies.filter(enemy => enemy.state != ENTITY_STATE_ENUM.DEATH)\n\n        console.log('y', y)\n\n        //先判断输入上时候\n        if (inputDirection === ENUM_BOTTOM_CONTROLLER.TOP) {\n            const playerNextY = y - 1\n            const playerNextX = x - 1\n\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                //判断是否超出地图\n                if (playerNextY <= 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                const weaponNextY = y - 2\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                // this.checkCollisionDoor(ENTITY_STATE_ENUM.BLOCKFRONT)\n\n                // 判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === x && enemyY === weaponNextY) || (enemyX === x && enemyY === playerNextY)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                        return true\n                    }\n                }\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                //判断是否超出地图\n                if (playerNextY <= 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                const weaponNextY = y\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === x && doorY === playerNextY) || (doorX === x && doorY === weaponNextY)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if (enemyX === x && enemyY === playerNextY) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                        return true\n                    }\n                }\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                //判断是否超出地图\n                if (playerNextY <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === weaponNextY)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === weaponNextY)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                        return true\n                    }\n                }\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                //判断是否超出地图\n                if (playerNextY <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === weaponNextY)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === weaponNextY)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                        return true\n                    }\n                }\n            }\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.LEFT) {\n            const playerNextY = y - 1\n            const playerNextX = x - 1\n\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                //判断是否超出地图\n                if (playerNextX <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === weaponNextY)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === weaponNextY)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                        return true\n                    }\n                }\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                //判断是否超出地图\n                if (playerNextX <= 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === weaponNextY)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === weaponNextY)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                        return true\n                    }\n                }\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                //判断是否超出地图\n                if (playerNextX <= 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n\n                    return true\n                }\n\n                const weaponNextX = x - 2\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === y)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === y)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                        return true\n                    }\n                }\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                //判断是否超出地图\n                if (playerNextX <= 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n\n                    return true\n                }\n\n                const weaponNextX = x\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === y)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if (enemyX === playerNextX && enemyY === y) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                        return true\n                    }\n                }\n            }\n\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.RIGHT) {\n            const playerNextX = x + 1\n\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === weaponNextY)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === weaponNextY)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                        return true\n                    }\n                }\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === weaponNextY)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === weaponNextY)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                        return true\n                    }\n                }\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n\n                    return true\n                }\n\n                const weaponNextX = x\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === y)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if (enemyX === playerNextX && enemyY === y) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                        return true\n                    }\n                }\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n\n                    return true\n                }\n\n                const weaponNextX = x + 2\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                //判断门\n                if (\n                    ((doorX === playerNextX && doorY === y) || (doorX === weaponNextX && doorY === y)) &&\n                    doorState !== ENTITY_STATE_ENUM.DEATH\n                ) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                //判断敌人\n                for (let i = 0; i < enemies.length; i++) {\n                    const enemy = enemies[i]\n                    const { x: enemyX, y: enemyY } = enemy\n\n                    if ((enemyX === playerNextX && enemyY === y) || (enemyX === weaponNextX && enemyY === y)) {\n                        this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                        return true\n                    }\n                }\n\n            }\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.BOTTOM) {\n            const playerNextY = y + 1\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                const weaponNextY = y\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n\n                    return true\n                }\n\n                const weaponNextY = y + 2\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT)\n                if (checkEnemy)\n                    return checkEnemy\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n            }\n\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.TURNLEFT) {\n            let nextY, nextX\n            if (direction === DIRECTION_ENUM.TOP) {\n                //朝上左转的话，左上角三个tile都必须turnable为true，并且没有敌人\n                nextY = y - 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                nextY = y + 1\n                nextX = x + 1\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                nextY = y + 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                nextY = y - 1\n                nextX = x + 1\n            }\n\n            //最后判断地图元素\n            if (\n                (!tileMgrInfo[x]?.[nextY] || tileMgrInfo[x]?.[nextY].canTurn) &&\n                (!tileMgrInfo[nextX]?.[y] || tileMgrInfo[nextX]?.[y].canTurn) &&\n                (!tileMgrInfo[nextX]?.[nextY] || tileMgrInfo[nextX]?.[nextY].canTurn)\n            ) {\n                // empty\n            } else {\n                this.state = ENTITY_STATE_ENUM.BLOCKTURNLEFT\n                return true\n            }\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.TURNRIGHT) {\n            let nextX, nextY\n            if (direction === DIRECTION_ENUM.TOP) {\n                //朝上右转的话，右上角三个tile都必须turnable为true\n                nextY = y - 1\n                nextX = x + 1\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                nextY = y + 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                nextY = y - 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                nextY = y + 1\n                nextX = x + 1\n            }\n\n            //最后判断地图元素\n            if (\n                (!tileMgrInfo[x]?.[nextY] || tileMgrInfo[x]?.[nextY].canTurn) &&\n                (!tileMgrInfo[nextX]?.[y] || tileMgrInfo[nextX]?.[y].canTurn) &&\n                (!tileMgrInfo[nextX]?.[nextY] || tileMgrInfo[nextX]?.[nextY].canTurn)\n            ) {\n                // empty\n            } else {\n                this.state = ENTITY_STATE_ENUM.BLOCKTURNRIGHT\n                return true\n            }\n        }\n\n        return false\n    }\n\n    checkCollisionDoor(playerNextY, weaponNextY, state: ENTITY_STATE_ENUM) {\n        const { tartgetX: x, tartgetY: y, direction } = this\n        const { x: doorX, y: doorY, state: doorState } = DataManager.Instance.doorInfo\n\n        //判断门\n        if (\n            ((doorX === x && doorY === playerNextY) || (doorX === x && doorY === weaponNextY)) &&\n            doorState !== ENTITY_STATE_ENUM.DEATH\n        ) {\n            this.state = state\n            console.log('撞到了门')\n            return true\n        }\n\n        return false\n    }\n\n    checkCollisionEnenies(playerNextY, weaponNextY, state: ENTITY_STATE_ENUM) {\n        const { tartgetX: x, tartgetY: y, direction } = this\n        const enemies: EnemyMgr[] = DataManager.Instance.enemies.filter(enemy => enemy.state != ENTITY_STATE_ENUM.DEATH)\n        // 判断敌人\n        for (let i = 0; i < enemies.length; i++) {\n            const enemy = enemies[i]\n            const { x: enemyX, y: enemyY } = enemy\n\n            if ((enemyX === x && enemyY === weaponNextY) || (enemyX === x && enemyY === playerNextY)) {\n                this.state = state\n                console.log('撞到了敌人')\n                return true\n            }\n        }\n        return false\n    }\n\n    willAttack(inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        // let enemies = DataManager.Instance.enemies.filter(enemy => enemy.state != ENTITY_STATE_ENUM.DEATH)\n        let enemies = DataManager.Instance.enemies.filter((enemy) => { return enemy.state != ENTITY_STATE_ENUM.DEATH })\n\n        for (let index = 0; index < enemies.length; index++) {\n            const { x: enemyX, y: enemyY, id } = enemies[index];\n            if (inputDirection === ENUM_BOTTOM_CONTROLLER.TOP && this.direction === DIRECTION_ENUM.TOP && enemyX == this.x && enemyY == this.y - 2) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.BOTTOM && this.direction === DIRECTION_ENUM.BOTTOM && enemyX == this.x && enemyY == this.y + 2) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.LEFT && this.direction === DIRECTION_ENUM.LEFT && enemyX == this.x - 2 && enemyY == this.y) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.RIGHT && this.direction === DIRECTION_ENUM.RIGHT && enemyX == this.x + 2 && enemyY == this.y) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            }\n        }\n\n        return ''\n    }\n\n    handlerMove(direction: ENUM_BOTTOM_CONTROLLER) {\n        console.log(DataManager.Instance.tileMgrInfo)\n        switch (direction) {\n            case ENUM_BOTTOM_CONTROLLER.TOP:\n                this.isMoving = true\n                this.tartgetY -= 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.BOTTOM:\n                this.isMoving = true\n                this.tartgetY += 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.LEFT:\n                this.isMoving = true\n                this.tartgetX -= 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.RIGHT:\n                this.isMoving = true\n                this.tartgetX += 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.TURNLEFT:\n                // this.fsm.setParams(PARAMS_NAME_TYPE.TURNLEFT, true)\n\n                if (this.direction === DIRECTION_ENUM.TOP) {\n                    this.direction = DIRECTION_ENUM.LEFT\n                } else if (this.direction === DIRECTION_ENUM.BOTTOM) {\n                    this.direction = DIRECTION_ENUM.RIGHT\n                } else if (this.direction === DIRECTION_ENUM.LEFT) {\n                    this.direction = DIRECTION_ENUM.BOTTOM\n                } else if (this.direction === DIRECTION_ENUM.RIGHT) {\n                    this.direction = DIRECTION_ENUM.TOP\n                }\n                this.state = ENTITY_STATE_ENUM.TURNLEFT\n                break;\n            case ENUM_BOTTOM_CONTROLLER.TURNRIGHT:\n                if (this.direction === DIRECTION_ENUM.TOP) {\n                    this.direction = DIRECTION_ENUM.RIGHT\n                } else if (this.direction === DIRECTION_ENUM.BOTTOM) {\n                    this.direction = DIRECTION_ENUM.LEFT\n                } else if (this.direction === DIRECTION_ENUM.LEFT) {\n                    this.direction = DIRECTION_ENUM.TOP\n                } else if (this.direction === DIRECTION_ENUM.RIGHT) {\n                    this.direction = DIRECTION_ENUM.BOTTOM\n                }\n                this.state = ENTITY_STATE_ENUM.TURNRIGHT\n                break;\n\n            default:\n                break;\n        }\n    }\n}"]}