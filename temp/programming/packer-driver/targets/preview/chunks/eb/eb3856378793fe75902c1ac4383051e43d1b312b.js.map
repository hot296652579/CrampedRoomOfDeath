{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Player/PlayerMgr.ts"],"names":["_decorator","DIRECTION_ENUM","ENTITY_STATE_ENUM","ENUM_EVENT","ENUM_BOTTOM_CONTROLLER","SHAKE_TYPE_ENUM","EventMgr","DataManager","PlayerStateMachine","EnitiyMgr","MOVE_SPEED","ccclass","property","PlayerMrg","tartgetX","tartgetY","isMoving","init","params","fsm","addComponent","x","y","onLoad","Instance","addEventListen","ENUM_MOVE_PLAYER","inputHanlder","ENUM_ATTACK_PLAYER","onDeathHanlder","ENUM_PLAYER_DEATH","onDestry","unEventListen","update","updateXY","Math","abs","emit","ENUM_MOVE_END","inputDirection","state","DEATH","AIRDEATH","ATTACK","enemyId","willAttack","ENUM_ENEMY_DEATH","ENUM_OPEN_DOOR","willBlock","TOP","ENUM_SHAKE_SCREEN","BOTTOM","LEFT","RIGHT","TURNLEFT","TURNRIGHT","handlerMove","type","direction","tileMgrInfo","mapColumCount","mapRowCount","doorX","doorY","doorState","doorInfo","enemies","filter","enemy","console","log","playerNextY","playerNextX","BLOCKFRONT","weaponNextY","nextPlayerTile","nextWeaponTile","canMove","canTurn","checkDoor","checkCollisionDoor","checkEnemy","checkCollisionEnenies","checkBurst","checkBurstCollision","BLOCKBACK","BLOCKRIGHT","weaponNextX","BLOCKLEFT","nextY","nextX","BLOCKTURNLEFT","i","length","enemyX","enemyY","BLOCKTURNRIGHT","playerNext","weaponNext","bursts","burst","some","index","id","onSmokeHandler","ENUM_SHOW_SMOKE"],"mappings":"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","sourcesContent":["import { Component, _decorator, Node, Sprite, UITransform, Animation, SpriteAtlas, AnimationClip, animation, SpriteFrame, Texture2D, math } from \"cc\";\nimport { DIRECTION_ENUM, DIRECTION_ORDER_ENUM, ENITIY_TYPE_ENUM, ENTITY_STATE_ENUM, ENUM_EVENT, ENUM_BOTTOM_CONTROLLER, PARAMS_NAME_TYPE, SHAKE_TYPE_ENUM } from \"../../Enum\";\nimport levels, { IEnitiy, ILevel } from \"../../Levels\";\nimport EventMgr from \"../Base/EventMgr\";\nimport ResourceLoadMgr from \"../Base/ResourceLoadMgr\";\nimport DataManager from \"../Runtime/DataManager\";\nimport { TILE_HEIGHT, TILE_WIDTH } from \"../TileMap/TileManager\";\n// import { DataManager.Instance } from \"../Runtime/DataManager\";\nimport { TileMapManager } from \"../TileMap/TileMapManager\";\nimport { createNewNode } from \"../Utils\";\nimport { PlayerStateMachine } from \"./PlayerStateMachine\";\nimport { EnitiyMgr } from \"../Base/EnitiyMgr\";\nimport { EnemyMgr } from \"../Base/EnemyMgr\";\nimport { BurstMgr } from \"../Burst/BurstMgr\";\n\nexport const MOVE_SPEED = 1 / 10\n\nconst { ccclass, property } = _decorator;\n@ccclass('PlayerMrg')\nexport class PlayerMrg extends EnitiyMgr {\n\n    tartgetX: number = 0\n    tartgetY: number = 0\n    isMoving: boolean = false\n\n    async init(params: IEnitiy) {\n        this.fsm = this.addComponent(PlayerStateMachine)\n        await this.fsm.init()\n\n        super.init(params)\n\n        this.tartgetX = this.x\n        this.tartgetY = this.y\n    }\n\n    onLoad() {\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_MOVE_PLAYER, this.inputHanlder, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_ATTACK_PLAYER, this.onDeathHanlder, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_PLAYER_DEATH, this.onDeathHanlder, this)\n    }\n\n    onDestry() {\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_MOVE_PLAYER, this.inputHanlder)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_ATTACK_PLAYER, this.onDeathHanlder)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_PLAYER_DEATH, this.onDeathHanlder)\n    }\n\n    update() {\n        this.updateXY()\n        super.update()\n    }\n\n    updateXY() {\n        if (this.tartgetX < this.x) {\n            this.x -= MOVE_SPEED\n        } else if (this.tartgetX > this.x) {\n            this.x += MOVE_SPEED\n        } else if (this.tartgetY < this.y) {\n            this.y -= MOVE_SPEED\n        } else if (this.tartgetY > this.y) {\n            this.y += MOVE_SPEED\n        }\n\n        if (Math.abs(this.tartgetX - this.x) <= 0.1 && Math.abs(this.tartgetY - this.y) <= 0.1 && this.isMoving) {\n            this.isMoving = false\n            this.x = this.tartgetX\n            this.y = this.tartgetY\n\n            EventMgr.Instance.emit(ENUM_EVENT.ENUM_MOVE_END)\n        }\n    }\n\n    inputHanlder(inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        if (this.state === ENTITY_STATE_ENUM.DEATH || this.state === ENTITY_STATE_ENUM.AIRDEATH || this.state === ENTITY_STATE_ENUM.ATTACK)\n            return\n\n        if (this.isMoving)\n            return\n\n\n        const enemyId = this.willAttack(inputDirection)\n        if (enemyId) {\n            EventMgr.Instance.emit(ENUM_EVENT.ENUM_ENEMY_DEATH, enemyId)\n            EventMgr.Instance.emit(ENUM_EVENT.ENUM_OPEN_DOOR)\n            return\n        }\n\n        if (this.willBlock(inputDirection)) {\n            if (inputDirection === ENUM_BOTTOM_CONTROLLER.TOP) {\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_SHAKE_SCREEN, SHAKE_TYPE_ENUM.TOP)\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.BOTTOM) {\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_SHAKE_SCREEN, SHAKE_TYPE_ENUM.BOTTOM)\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.LEFT) {\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_SHAKE_SCREEN, SHAKE_TYPE_ENUM.LEFT)\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.RIGHT) {\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_SHAKE_SCREEN, SHAKE_TYPE_ENUM.RIGHT)\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.TURNLEFT) {\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_SHAKE_SCREEN, SHAKE_TYPE_ENUM.LEFT)\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.TURNRIGHT) {\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_SHAKE_SCREEN, SHAKE_TYPE_ENUM.RIGHT)\n            }\n            return\n        }\n\n        this.handlerMove(inputDirection)\n    }\n\n    onDeathHanlder(type: ENTITY_STATE_ENUM) {\n        this.state = type\n    }\n\n    willBlock(inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        const { tartgetX: x, tartgetY: y, direction } = this\n        const { tileMgrInfo, mapColumCount, mapRowCount } = DataManager.Instance\n        const { x: doorX, y: doorY, state: doorState } = DataManager.Instance.doorInfo\n        const enemies: EnemyMgr[] = DataManager.Instance.enemies.filter(enemy => enemy.state != ENTITY_STATE_ENUM.DEATH)\n\n        console.log('y', y)\n\n        //先判断输入上时候\n        if (inputDirection === ENUM_BOTTOM_CONTROLLER.TOP) {\n            const playerNextY = y - 1\n            const playerNextX = x - 1\n\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                //判断是否超出地图\n                if (playerNextY <= 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                const weaponNextY = y - 2\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextY, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                //判断是否超出地图\n                if (playerNextY <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                const weaponNextY = y\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextY, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                //判断是否超出地图\n                if (playerNextY <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKRIGHT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKRIGHT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                //判断是否超出地图\n                if (playerNextY <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n            }\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.LEFT) {\n            const playerNextY = y - 1\n            const playerNextX = x - 1\n\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                //判断是否超出地图\n                if (playerNextX <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                //判断是否超出地图\n                if (playerNextX <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                //判断是否超出地图\n                if (playerNextX <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n\n                    return true\n                }\n\n                const weaponNextX = x - 2\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                //判断是否超出地图\n                if (playerNextX <= 0) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n\n                    return true\n                }\n\n                const weaponNextX = x\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n            }\n\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.RIGHT) {\n            const playerNextX = x + 1\n\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y - 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n\n                    return true\n                }\n\n                const weaponNextX = x\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                if (playerNextX > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n\n                    return true\n                }\n\n                const weaponNextX = x + 2\n                const nextPlayerTile = tileMgrInfo[playerNextX]?.[y]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[y]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextX, weaponNextX, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextX, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n            }\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.BOTTOM) {\n            const playerNextY = y + 1\n            //玩家方向——向上\n            if (direction === DIRECTION_ENUM.TOP) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                const weaponNextY = y\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextY, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKBACK\n                    return true\n                }\n\n                //玩家方向——向下\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n\n                    return true\n                }\n\n                const weaponNextY = y + 2\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[x]?.[weaponNextY]\n\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextY, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKFRONT\n                    return true\n                }\n\n                //玩家方向——向左\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n\n                    return true\n                }\n\n                const weaponNextX = x - 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKLEFT\n                    return true\n                }\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (!checkEnemy)\n                    return checkEnemy\n\n                //玩家方向——向右\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                if (playerNextY > mapColumCount - 1) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n\n                    return true\n                }\n\n                const weaponNextX = x + 1\n                const weaponNextY = y + 1\n                const nextPlayerTile = tileMgrInfo[x]?.[playerNextY]\n                const nextWeaponTile = tileMgrInfo[weaponNextX]?.[weaponNextY]\n\n                const checkDoor = this.checkCollisionDoor(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkDoor)\n                    return checkDoor\n\n                const checkEnemy = this.checkCollisionEnenies(playerNextY, weaponNextY, ENTITY_STATE_ENUM.BLOCKFRONT, inputDirection)\n                if (checkEnemy)\n                    return checkEnemy\n\n                const checkBurst = this.checkBurstCollision(playerNextY, nextWeaponTile, inputDirection)\n                if (!checkBurst)\n                    return checkBurst\n\n                //最后判断地图元素\n                if (nextPlayerTile && nextPlayerTile.canMove && (!nextWeaponTile || nextWeaponTile.canTurn)) {\n                    // empty\n                } else {\n                    this.state = ENTITY_STATE_ENUM.BLOCKRIGHT\n                    return true\n                }\n            }\n\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.TURNLEFT) {\n            let nextY, nextX\n            if (direction === DIRECTION_ENUM.TOP) {\n                //朝上左转的话，左上角三个tile都必须turnable为true，并且没有敌人\n                nextY = y - 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                nextY = y + 1\n                nextX = x + 1\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                nextY = y + 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                nextY = y - 1\n                nextX = x + 1\n            }\n\n            //最后判断地图元素\n            if (\n                (!tileMgrInfo[x]?.[nextY] || tileMgrInfo[x]?.[nextY].canTurn) &&\n                (!tileMgrInfo[nextX]?.[y] || tileMgrInfo[nextX]?.[y].canTurn) &&\n                (!tileMgrInfo[nextX]?.[nextY] || tileMgrInfo[nextX]?.[nextY].canTurn)\n            ) {\n                // empty\n            } else {\n                this.state = ENTITY_STATE_ENUM.BLOCKTURNLEFT\n                return true\n            }\n\n            //判断门\n            if (\n                ((doorX === x && doorY === nextY) ||\n                    (doorX === nextX && doorY === y) ||\n                    (doorX === nextX && doorY === nextY)) &&\n                doorState !== ENTITY_STATE_ENUM.DEATH\n            ) {\n                this.state = ENTITY_STATE_ENUM.BLOCKTURNLEFT\n                return true\n            }\n\n            //判断敌人\n            for (let i = 0; i < enemies.length; i++) {\n                const enemy = enemies[i]\n                const { x: enemyX, y: enemyY } = enemy\n\n                if (enemyX === nextX && enemyY === y) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKTURNLEFT\n\n                    return true\n                } else if (enemyX === nextX && enemyY === nextY) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKTURNLEFT\n\n                    return true\n                } else if (enemyX === x && enemyY === nextY) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKTURNLEFT\n\n                    return true\n                }\n            }\n        } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.TURNRIGHT) {\n            let nextX, nextY\n            if (direction === DIRECTION_ENUM.TOP) {\n                //朝上右转的话，右上角三个tile都必须turnable为true\n                nextY = y - 1\n                nextX = x + 1\n            } else if (direction === DIRECTION_ENUM.BOTTOM) {\n                nextY = y + 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.LEFT) {\n                nextY = y - 1\n                nextX = x - 1\n            } else if (direction === DIRECTION_ENUM.RIGHT) {\n                nextY = y + 1\n                nextX = x + 1\n            }\n\n            //最后判断地图元素\n            if (\n                (!tileMgrInfo[x]?.[nextY] || tileMgrInfo[x]?.[nextY].canTurn) &&\n                (!tileMgrInfo[nextX]?.[y] || tileMgrInfo[nextX]?.[y].canTurn) &&\n                (!tileMgrInfo[nextX]?.[nextY] || tileMgrInfo[nextX]?.[nextY].canTurn)\n            ) {\n                // empty\n            } else {\n                this.state = ENTITY_STATE_ENUM.BLOCKTURNRIGHT\n                return true\n            }\n\n            //判断门\n            if (\n                ((doorX === x && doorY === nextY) ||\n                    (doorX === nextX && doorY === y) ||\n                    (doorX === nextX && doorY === nextY)) &&\n                doorState !== ENTITY_STATE_ENUM.DEATH\n            ) {\n                this.state = ENTITY_STATE_ENUM.BLOCKTURNRIGHT\n                return true\n            }\n\n            //判断敌人\n            for (let i = 0; i < enemies.length; i++) {\n                const enemy = enemies[i]\n                const { x: enemyX, y: enemyY } = enemy\n\n                if (enemyX === nextX && enemyY === y) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKTURNRIGHT\n\n                    return true\n                } else if (enemyX === nextX && enemyY === nextY) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKTURNRIGHT\n\n                    return true\n                } else if (enemyX === x && enemyY === nextY) {\n                    this.state = ENTITY_STATE_ENUM.BLOCKTURNRIGHT\n\n                    return true\n                }\n            }\n        }\n\n        return false\n    }\n\n    checkCollisionDoor(playerNext, weaponNext, state: ENTITY_STATE_ENUM, inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        const { tartgetX: x, tartgetY: y, direction } = this\n        const { x: doorX, y: doorY, state: doorState } = DataManager.Instance.doorInfo\n\n        if (inputDirection === ENUM_BOTTOM_CONTROLLER.TOP || inputDirection === ENUM_BOTTOM_CONTROLLER.BOTTOM) {\n            //判断上下门\n            if (\n                ((doorX === x && doorY === playerNext) || (doorX === x && doorY === weaponNext)) &&\n                doorState !== ENTITY_STATE_ENUM.DEATH\n            ) {\n                this.state = state\n                console.log('撞到了门')\n                return true\n            }\n        } else {\n            //判断左右门\n            if (\n                ((doorX === playerNext && doorY === y) || (doorX === weaponNext && doorY === weaponNext)) &&\n                doorState !== ENTITY_STATE_ENUM.DEATH\n            ) {\n                this.state = state\n                console.log('撞到了门')\n                return true\n            }\n        }\n\n\n\n        return false\n    }\n\n    checkCollisionEnenies(playerNext, weaponNext, state: ENTITY_STATE_ENUM, inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        const { tartgetX: x, tartgetY: y, direction } = this\n        const enemies: EnemyMgr[] = DataManager.Instance.enemies.filter(enemy => enemy.state != ENTITY_STATE_ENUM.DEATH)\n\n        if (inputDirection === ENUM_BOTTOM_CONTROLLER.TOP || inputDirection === ENUM_BOTTOM_CONTROLLER.BOTTOM) {\n            for (let i = 0; i < enemies.length; i++) {\n                const enemy = enemies[i]\n                const { x: enemyX, y: enemyY } = enemy\n\n                if ((enemyX === x && enemyY === weaponNext) || (enemyX === x && enemyY === playerNext)) {\n                    this.state = state\n                    console.log('撞到了敌人')\n                    return true\n                }\n            }\n        }\n\n        return false\n    }\n\n    //判断地裂陷阱\n    checkBurstCollision(playerNext, nextWeaponTile, inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        const { tartgetX: x, tartgetY: y, direction } = this\n        const bursts: BurstMgr[] = DataManager.Instance.bursts.filter(\n            (burst: BurstMgr) => burst.state !== ENTITY_STATE_ENUM.DEATH,\n        )\n\n        if (\n            bursts.some(burst => burst.x === x && burst.y === playerNext) &&\n            (!nextWeaponTile || nextWeaponTile.canTurn)\n        ) {\n            return false\n        }\n    }\n\n    willAttack(inputDirection: ENUM_BOTTOM_CONTROLLER) {\n        // let enemies = DataManager.Instance.enemies.filter(enemy => enemy.state != ENTITY_STATE_ENUM.DEATH)\n        let enemies = DataManager.Instance.enemies.filter((enemy) => { return enemy.state != ENTITY_STATE_ENUM.DEATH })\n\n        for (let index = 0; index < enemies.length; index++) {\n            const { x: enemyX, y: enemyY, id } = enemies[index];\n            if (inputDirection === ENUM_BOTTOM_CONTROLLER.TOP && this.direction === DIRECTION_ENUM.TOP && enemyX == this.x && enemyY == this.y - 2) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.BOTTOM && this.direction === DIRECTION_ENUM.BOTTOM && enemyX == this.x && enemyY == this.y + 2) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.LEFT && this.direction === DIRECTION_ENUM.LEFT && enemyX == this.x - 2 && enemyY == this.y) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            } else if (inputDirection === ENUM_BOTTOM_CONTROLLER.RIGHT && this.direction === DIRECTION_ENUM.RIGHT && enemyX == this.x + 2 && enemyY == this.y) {\n                this.state = ENTITY_STATE_ENUM.ATTACK\n                return id\n            }\n        }\n\n        return ''\n    }\n\n    handlerMove(direction: ENUM_BOTTOM_CONTROLLER) {\n        console.log(DataManager.Instance.tileMgrInfo)\n        switch (direction) {\n            case ENUM_BOTTOM_CONTROLLER.TOP:\n                this.isMoving = true\n                this.onSmokeHandler(direction)\n                this.tartgetY -= 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.BOTTOM:\n                this.isMoving = true\n                this.onSmokeHandler(direction)\n                this.tartgetY += 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.LEFT:\n                this.isMoving = true\n                this.onSmokeHandler(direction)\n                this.tartgetX -= 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.RIGHT:\n                this.isMoving = true\n                this.onSmokeHandler(direction)\n                this.tartgetX += 1\n                break;\n            case ENUM_BOTTOM_CONTROLLER.TURNLEFT:\n                // this.fsm.setParams(PARAMS_NAME_TYPE.TURNLEFT, true)\n\n                if (this.direction === DIRECTION_ENUM.TOP) {\n                    this.direction = DIRECTION_ENUM.LEFT\n                } else if (this.direction === DIRECTION_ENUM.BOTTOM) {\n                    this.direction = DIRECTION_ENUM.RIGHT\n                } else if (this.direction === DIRECTION_ENUM.LEFT) {\n                    this.direction = DIRECTION_ENUM.BOTTOM\n                } else if (this.direction === DIRECTION_ENUM.RIGHT) {\n                    this.direction = DIRECTION_ENUM.TOP\n                }\n                this.state = ENTITY_STATE_ENUM.TURNLEFT\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_MOVE_END)\n                break;\n            case ENUM_BOTTOM_CONTROLLER.TURNRIGHT:\n                if (this.direction === DIRECTION_ENUM.TOP) {\n                    this.direction = DIRECTION_ENUM.RIGHT\n                } else if (this.direction === DIRECTION_ENUM.BOTTOM) {\n                    this.direction = DIRECTION_ENUM.LEFT\n                } else if (this.direction === DIRECTION_ENUM.LEFT) {\n                    this.direction = DIRECTION_ENUM.TOP\n                } else if (this.direction === DIRECTION_ENUM.RIGHT) {\n                    this.direction = DIRECTION_ENUM.BOTTOM\n                }\n                this.state = ENTITY_STATE_ENUM.TURNRIGHT\n                EventMgr.Instance.emit(ENUM_EVENT.ENUM_MOVE_END)\n                break;\n\n            default:\n                break;\n        }\n    }\n\n    onSmokeHandler(type: ENUM_BOTTOM_CONTROLLER) {\n        EventMgr.Instance.emit(ENUM_EVENT.ENUM_SHOW_SMOKE, this.x, this.y, type)\n    }\n}"]}