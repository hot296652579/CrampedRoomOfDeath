{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Base/EnemyMgr.ts"],"names":["_decorator","DIRECTION_ENUM","ENTITY_STATE_ENUM","ENUM_EVENT","DataManager","EnitiyMgr","EventMgr","ccclass","property","EnemyMgr","init","params","onChangeDirection","Instance","playerInfo","state","DEATH","x","playerX","y","playerY","disX","Math","abs","disY","direction","TOP","RIGHT","LEFT","BOTTOM","onDeath","id","onLoad","addEventListen","ENUM_MOVE_END","ENUM_PLAYER_BORN","ENUM_ENEMY_DEATH","onDestry","unEventListen"],"mappings":"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","sourcesContent":["/**木骷髅管理器 */\nimport { Component, _decorator, Node, Sprite, UITransform, Animation, SpriteAtlas, AnimationClip, animation, SpriteFrame, Texture2D, math } from \"cc\";\nimport { DIRECTION_ENUM, ENTITY_STATE_ENUM, ENUM_EVENT } from \"../../Enum\";\nimport { IEnitiy } from \"../../Levels\";\nimport DataManager from \"../Runtime/DataManager\";\nimport { EnitiyMgr } from \"./EnitiyMgr\";\nimport EventMgr from \"./EventMgr\";\n\nconst { ccclass, property } = _decorator;\n@ccclass('EnemyMgr')\nexport class EnemyMgr extends EnitiyMgr {\n\n    async init(params: IEnitiy) {\n        super.init(params)\n    }\n    /***\n     * 根据玩家在敌人的象限改变敌人的朝向\n     */\n    onChangeDirection() {\n        if (!DataManager.Instance.playerInfo)\n            return\n        if (this.state === ENTITY_STATE_ENUM.DEATH || !DataManager.Instance.playerInfo)\n            return\n\n        const { x: playerX, y: playerY } = DataManager.Instance.playerInfo\n        const disX = Math.abs(this.x - playerX)\n        const disY = Math.abs(this.y - playerY)\n\n        if (playerX >= this.x && playerY <= this.y) {\n            disY > disX ? this.direction = DIRECTION_ENUM.TOP : this.direction = DIRECTION_ENUM.RIGHT\n        } else if (playerX <= this.x && playerY <= this.y) {\n            disY > disX ? this.direction = DIRECTION_ENUM.TOP : this.direction = DIRECTION_ENUM.LEFT\n        } else if (playerX <= this.x && this.y >= playerY) {\n            disY > disX ? this.direction = DIRECTION_ENUM.BOTTOM : this.direction = DIRECTION_ENUM.LEFT\n        } else if (playerX >= this.x && this.y >= playerY) {\n            disY > disX ? this.direction = DIRECTION_ENUM.BOTTOM : this.direction = DIRECTION_ENUM.RIGHT\n        }\n    }\n\n    onDeath(id: string) {\n        if (this.state === ENTITY_STATE_ENUM.DEATH) {\n            return\n        }\n        if (this.id === id) {\n            this.state = ENTITY_STATE_ENUM.DEATH\n        }\n    }\n\n    onLoad() {\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_MOVE_END, this.onChangeDirection, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_PLAYER_BORN, this.onChangeDirection, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_ENEMY_DEATH, this.onDeath, this)\n    }\n\n    onDestry() {\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_MOVE_END, this.onChangeDirection)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_PLAYER_BORN, this.onChangeDirection)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_ENEMY_DEATH, this.onDeath)\n    }\n\n\n}"]}