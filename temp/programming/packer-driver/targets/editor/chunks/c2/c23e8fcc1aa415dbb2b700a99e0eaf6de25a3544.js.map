{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Scene/UILoadingScene.ts"],"names":["_decorator","Component","director","ProgressBar","resources","AudioClip","SCENE_ENUM","ccclass","property","LoadingManager","onLoad","preLoad","preloadScene","BATTLE","preloadDir","cur","total","console","log","bar","progress","err","Promise","rs","setTimeout","loadSoundRes","loadScene"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,S,OAAAA,S;;AACzDC,MAAAA,U,iBAAAA,U;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;gCAGjBS,c,WADZF,OAAO,CAAC,gBAAD,C,UAEHC,QAAQ,CAACL,WAAD,C,2BAFb,MACaM,cADb,SACoCR,SADpC,CAC8C;AAAA;AAAA;;AAAA;AAAA;;AAI1CS,QAAAA,MAAM,GAAG;AACL,eAAKC,OAAL;AACH;;AACDA,QAAAA,OAAO,GAAG;AACNT,UAAAA,QAAQ,CAACU,YAAT,CAAsB;AAAA;AAAA,wCAAWC,MAAjC;AACAT,UAAAA,SAAS,CAACU,UAAV,CACI,SADJ,EAEI,CAACC,GAAD,EAAMC,KAAN,KAAgB;AACZC,YAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACA,iBAAKC,GAAL,CAASC,QAAT,GAAoBL,GAAG,GAAGC,KAA1B;AACH,WALL,EAMI,MAAMK,GAAN,IAAa;AACT,gBAAIA,GAAJ,EAAS;AACL,oBAAM,IAAIC,OAAJ,CAAYC,EAAE,IAAI;AACpBC,gBAAAA,UAAU,CAACD,EAAD,EAAK,IAAL,CAAV;AACH,eAFK,CAAN;AAGA,mBAAKZ,OAAL;AACA;AACH;;AACD,kBAAM,KAAKc,YAAL,EAAN;AACAvB,YAAAA,QAAQ,CAACwB,SAAT,CAAmB;AAAA;AAAA,0CAAWb,MAA9B;AACH,WAhBL;AAkBH;;AAEiB,cAAZY,YAAY,GAAG;AACjB,iBAAO,IAAIH,OAAJ,CAAaC,EAAD,IAAQ;AACvBnB,YAAAA,SAAS,CAACU,UAAV,CAAqB,OAArB,EAA8BT,SAA9B,EAAyC,MAAM;AAC3CY,cAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAK,cAAAA,EAAE,CAAC,IAAD,CAAF;AACH,aAHD;AAIH,WALM,CAAP;AAMH;;AApCyC,O","sourcesContent":["import { _decorator, Component, director, ProgressBar, resources, AudioClip } from 'cc'\nimport { SCENE_ENUM } from '../../Enum'\nconst { ccclass, property } = _decorator\n\n@ccclass('LoadingManager')\nexport class LoadingManager extends Component {\n    @property(ProgressBar)\n    bar: ProgressBar\n\n    onLoad() {\n        this.preLoad()\n    }\n    preLoad() {\n        director.preloadScene(SCENE_ENUM.BATTLE)\n        resources.preloadDir(\n            'texture',\n            (cur, total) => {\n                console.log('加载中....')\n                this.bar.progress = cur / total\n            },\n            async err => {\n                if (err) {\n                    await new Promise(rs => {\n                        setTimeout(rs, 1000)\n                    })\n                    this.preLoad()\n                    return\n                }\n                await this.loadSoundRes()\n                director.loadScene(SCENE_ENUM.BATTLE)\n            },\n        )\n    }\n\n    async loadSoundRes() {\n        return new Promise((rs) => {\n            resources.preloadDir('sound', AudioClip, () => {\n                console.log('音频资源预加载完成')\n                rs(null)\n            })\n        })\n    }\n}"]}