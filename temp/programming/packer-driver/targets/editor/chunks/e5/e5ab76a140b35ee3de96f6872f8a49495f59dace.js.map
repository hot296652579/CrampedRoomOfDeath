{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Scene/UIBattleScene.ts"],"names":["Component","_decorator","Node","director","ENITIY_TYPE_ENUM","ENTITY_STATE_ENUM","ENUM_EVENT","SCENE_ENUM","levels","EventMgr","BurstMgr","DoorMgr","IronMgr","WoodenMgr","PlayerMrg","AudioMgr","DataManager","FadeMgr","ShakeManager","SmokeMgr","SpikesMgr","TileMapManager","createNewNode","TILE_WIDTH","TILE_HEIGHT","ccclass","property","UIBattleScene","level","stage","smokeLayer","fadeInit","start","inst","play","Instance","levelIndex","generateStage","initLevel","onLoad","addEventListen","ENUM_NEXTLEVEL","nextLevelMap","ENUM_MOVE_END","checkArrived","ENUM_SHOW_SMOKE","showSmokeHandler","ENUM_RECORD_STEP","saveRecord","ENUM_REVOKE_STEP","revokeRecord","ENUM_RESTART_GAME","restartLoadSence","ENUM_WIN_RESTART_GAME","winRestartGame","onDestry","unEventListen","clearDir","console","log","loadScene","BATTLE","fader","fadeIn","mask","clearLevelMap","mapInfo","mapColumCount","length","mapRowCount","Promise","all","generateTileMap","generateBurst","generateEnemies","generateSpikes","generateDoor","generateSmokeLayer","fitPos","generatePlayer","fadeOut","win","active","removeAllChildren","reset","x","playerX","y","playerY","playerInfo","doorX","doorY","state","doorState","doorInfo","DEATH","emit","direction","smokeItem","smokes","find","smoke","node","setPosition","smokeNode","setParent","smokeMgr","addComponent","init","IDLE","type","SMOKE","push","stageNode","setSiblingIndex","tileMapNode","position","tileMapManager","playerNode","playerManager","player","ENUM_PLAYER_BORN","enemies","promises","i","enemy","mgr","WOODEN","manager","bursts","burst","burstManager","spikes","spikesManager","doorManager","door","disX","disY","getComponent","stop","item","ATTACK","_type","map","count","records","pop","targetX","targetY","index","spike"],"mappings":"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","sourcesContent":["import { Component, _decorator, Node, AudioSource, director } from \"cc\";\nimport { DIRECTION_ENUM, ENITIY_TYPE_ENUM, ENITIY_TYPE_SPIKES_ENUM, ENTITY_STATE_ENUM, ENUM_EVENT, SCENE_ENUM } from \"../../Enum\";\nimport levels, { ILevel } from \"../../Levels\";\nimport EventMgr from \"../Base/EventMgr\";\nimport { BurstMgr } from \"../Burst/BurstMgr\";\nimport { DoorMgr } from \"../Door/DoorMgr\";\nimport { IronMgr } from \"../Enemy/Iron/IronMgr\";\nimport { WoodenMgr } from \"../Enemy/Wooden/WoodenMgr\";\nimport { PlayerMrg } from \"../Player/PlayerMgr\";\nimport { AudioMgr } from \"../Runtime/AudioMgr\";\nimport DataManager, { IRecord } from \"../Runtime/DataManager\";\nimport FadeMgr from \"../Runtime/FadeMgr\";\nimport { ShakeManager } from \"../Runtime/ShakeManager\";\nimport SoundMgr from \"../Runtime/SoundMgr\";\nimport { SmokeMgr } from \"../Smoke/SmokeMgr\";\nimport { SpikesMgr } from \"../Spikes/SpikesMgr\";\n// import { DataManager.Instance } from \"../Runtime/DataManager\";\nimport { TileMapManager } from \"../TileMap/TileMapManager\";\nimport { createNewNode } from \"../Utils\";\n\nconst TILE_WIDTH = 55\nconst TILE_HEIGHT = 55\nconst { ccclass, property } = _decorator;\n@ccclass('UIBattleScene')\nexport class UIBattleScene extends Component {\n    level: ILevel\n    stage: Node\n    smokeLayer: Node\n    fadeInit = false\n    @property(Node)\n    menu: Node = null\n    @property(Node)\n    bottom: Node = null\n    @property(Node)\n    win: Node = null\n\n    start() {\n        AudioMgr.inst.play('sound/bg', 1, true)\n\n        DataManager.Instance.levelIndex = 2\n        this.generateStage()\n        this.initLevel()\n    }\n\n    onLoad() {\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_NEXTLEVEL, this.nextLevelMap, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_MOVE_END, this.checkArrived, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_SHOW_SMOKE, this.showSmokeHandler, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_RECORD_STEP, this.saveRecord, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_REVOKE_STEP, this.revokeRecord, this)\n        // EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_RESTART_GAME, this.initLevel, this)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_RESTART_GAME, this.restartLoadSence)\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_WIN_RESTART_GAME, this.winRestartGame, this)\n    }\n\n    onDestry() {\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_NEXTLEVEL, this.nextLevelMap)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_MOVE_END, this.checkArrived)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_SHOW_SMOKE, this.showSmokeHandler)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_RECORD_STEP, this.saveRecord)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_REVOKE_STEP, this.revokeRecord)\n        // EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_RESTART_GAME, this.initLevel)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_RESTART_GAME, this.restartLoadSence)\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_WIN_RESTART_GAME, this.winRestartGame)\n\n        EventMgr.Instance.clearDir()\n    }\n\n    private restartLoadSence() {\n        console.log('restartLoadSence')\n        EventMgr.Instance.clearDir()\n        director.loadScene(SCENE_ENUM.BATTLE)\n    }\n\n    async initLevel() {\n        if (this.fadeInit) {\n            await FadeMgr.Instance.fader.fadeIn()\n        } else {\n            await FadeMgr.Instance.fader.mask()\n        }\n\n        this.clearLevelMap()\n        this.level = levels[`level${DataManager.Instance.levelIndex}`]\n        if (this.level) {\n            DataManager.Instance.mapInfo = this.level.mapInfo\n            DataManager.Instance.mapColumCount = this.level.mapInfo[0]?.length || 0//åˆ—\n            DataManager.Instance.mapRowCount = this.level.mapInfo.length || 0\n        }\n\n        await Promise.all([\n            this.generateTileMap(),\n            this.generateBurst(),\n            this.generateEnemies(),\n            this.generateSpikes(),\n            this.generateDoor(),\n            this.generateSmokeLayer(),\n            this.fitPos()\n        ])\n        await this.generatePlayer()\n        FadeMgr.Instance.fader.fadeOut()\n        this.fadeInit = true\n    }\n\n    winRestartGame() {\n        this.win.active = false\n        DataManager.Instance.levelIndex = 1\n        this.initLevel()\n    }\n\n    nextLevelMap() {\n        DataManager.Instance.levelIndex++\n        if (DataManager.Instance.levelIndex > 10) {\n            this.win.active = true\n            return\n        }\n        this.initLevel()\n    }\n\n    clearLevelMap() {\n        this.stage.removeAllChildren()\n        DataManager.Instance.reset()\n    }\n\n    checkArrived() {\n        const { x: playerX, y: playerY } = DataManager.Instance.playerInfo\n        const { x: doorX, y: doorY, state: doorState } = DataManager.Instance.doorInfo\n\n        if (playerX === doorX && playerY === doorY &&\n            doorState === ENTITY_STATE_ENUM.DEATH) {\n            EventMgr.Instance.emit(ENUM_EVENT.ENUM_NEXTLEVEL)\n        }\n    }\n\n    async showSmokeHandler(x: number, y: number, direction: DIRECTION_ENUM) {\n        const smokeItem = DataManager.Instance.smokes.find(smoke => smoke.state === ENTITY_STATE_ENUM.DEATH)\n        if (smokeItem) {\n            smokeItem.x = x\n            smokeItem.y = y\n            smokeItem.direction = direction\n            smokeItem.node.setPosition(x * TILE_WIDTH - TILE_WIDTH * 1.5, -y * TILE_HEIGHT + TILE_HEIGHT * 1.5)\n        } else {\n            const smokeNode = createNewNode()\n            smokeNode.setParent(this.smokeLayer)\n            const smokeMgr = smokeNode.addComponent(SmokeMgr)\n            await smokeMgr.init({\n                x,\n                y,\n                state: ENTITY_STATE_ENUM.IDLE,\n                type: ENITIY_TYPE_ENUM.SMOKE,\n                direction\n            })\n\n            DataManager.Instance.smokes.push(smokeMgr)\n        }\n    }\n\n    generateStage() {\n        const stageNode = createNewNode()\n        stageNode.setParent(this.node)\n        this.stage = stageNode\n        this.stage.setSiblingIndex(2)\n        this.stage.addComponent(ShakeManager)\n    }\n\n    async generateTileMap() {\n        const tileMapNode = createNewNode()\n        tileMapNode.setParent(this.stage)\n        console.log('tileMapNode.position', tileMapNode.position)\n        const tileMapManager = tileMapNode.addComponent(TileMapManager)\n        await tileMapManager.init()\n    }\n\n    async generatePlayer() {\n        const playerNode = createNewNode()\n        playerNode.setParent(this.stage)\n        const playerManager = playerNode.addComponent(PlayerMrg)\n        await playerManager.init(this.level.player)\n        DataManager.Instance.playerInfo = playerManager\n        EventMgr.Instance.emit(ENUM_EVENT.ENUM_PLAYER_BORN, true)\n    }\n\n    async generateEnemies() {\n        DataManager.Instance.enemies = []\n        const promises = []\n        for (let i = 0; i < this.level.enemies.length; i++) {\n            const enemy = this.level.enemies[i]\n            const node = createNewNode()\n            node.setParent(this.stage)\n            const mgr = enemy.type === ENITIY_TYPE_ENUM.WOODEN ? WoodenMgr : IronMgr\n            const manager = node.addComponent(mgr)\n            promises.push(manager.init(enemy))\n            DataManager.Instance.enemies.push(manager)\n        }\n\n        await Promise.all(promises)\n    }\n\n    async generateBurst() {\n        const promises = []\n        for (let i = 0; i < this.level.bursts.length; i++) {\n            const burst = this.level.bursts[i]\n            const node = createNewNode()\n            node.setParent(this.stage)\n            const burstManager = node.addComponent(BurstMgr)\n            promises.push(burstManager.init(burst))\n            DataManager.Instance.bursts.push(burstManager)\n        }\n        await Promise.all(promises)\n    }\n\n    async generateSpikes() {\n        const promises = []\n        for (let i = 0; i < this.level.spikes.length; i++) {\n            const spikes = this.level.spikes[i]\n            const node = createNewNode()\n            node.setParent(this.stage)\n            const spikesManager = node.addComponent(SpikesMgr)\n            promises.push(spikesManager.init(spikes))\n            DataManager.Instance.spikes.push(spikesManager)\n        }\n        await Promise.all(promises)\n    }\n\n    generateSmokeLayer() {\n        const node = createNewNode()\n        this.smokeLayer = node\n        node.setParent(this.stage)\n    }\n\n    async generateDoor() {\n        const node = createNewNode()\n        node.setParent(this.stage)\n        const doorManager = node.addComponent(DoorMgr)\n        await doorManager.init(this.level.door)\n        DataManager.Instance.doorInfo = doorManager\n    }\n\n    fitPos() {\n        const { mapColumCount, mapRowCount } = DataManager.Instance\n        const disX = TILE_WIDTH * mapRowCount / 2\n        const disY = TILE_HEIGHT * mapColumCount / 2 + 100\n        this.stage.getComponent(ShakeManager).stop()\n        this.stage.setPosition(-disX, disY)\n    }\n\n    saveRecord() {\n        if (!DataManager.Instance.playerInfo)\n            return\n\n        const item: IRecord = {\n            player: {\n                x: DataManager.Instance.playerInfo.x,\n                y: DataManager.Instance.playerInfo.y,\n                direction: DataManager.Instance.playerInfo.direction,\n                state: DataManager.Instance.playerInfo.state === ENTITY_STATE_ENUM.IDLE ||\n                    DataManager.Instance.playerInfo.state === ENTITY_STATE_ENUM.ATTACK ||\n                    DataManager.Instance.playerInfo.state === ENTITY_STATE_ENUM.DEATH\n                    ? DataManager.Instance.playerInfo.state : ENTITY_STATE_ENUM.IDLE\n                ,\n                type: DataManager.Instance.playerInfo._type,\n            },\n            door: {\n                x: DataManager.Instance.doorInfo.x,\n                y: DataManager.Instance.doorInfo.y,\n                direction: DataManager.Instance.doorInfo.direction,\n                state: DataManager.Instance.doorInfo.state,\n                type: DataManager.Instance.doorInfo._type,\n            },\n            enemies: DataManager.Instance.enemies.map(({ x, y, type, state, direction }) => ({\n                x, y, type, state, direction\n            })),\n            bursts: DataManager.Instance.bursts.map(({ x, y, type, state, direction }) => ({\n                x, y, type, state, direction\n            })),\n            spikes: DataManager.Instance.spikes.map(({ x, y, count, type }) => ({\n                x, y, count, type\n            })),\n        }\n\n        DataManager.Instance.records.push(item)\n    }\n\n    revokeRecord() {\n        const item = DataManager.Instance.records.pop()\n        if (item) {\n            DataManager.Instance.playerInfo.x = DataManager.Instance.playerInfo.targetX = item.player.x\n            DataManager.Instance.playerInfo.y = DataManager.Instance.playerInfo.targetY = item.player.y\n            DataManager.Instance.playerInfo.direction = item.player.direction\n            DataManager.Instance.playerInfo.state = item.player.state\n            DataManager.Instance.playerInfo.type = item.player.type\n\n            DataManager.Instance.doorInfo.x = item.door.x\n            DataManager.Instance.doorInfo.y = item.door.y\n            DataManager.Instance.doorInfo.direction = item.door.direction\n            DataManager.Instance.doorInfo.state = item.door.state\n            DataManager.Instance.doorInfo.type = item.door.type\n\n            for (let index = 0; index < DataManager.Instance.enemies.length; index++) {\n                const enemy = item.enemies[index];\n                DataManager.Instance.enemies[index].x = enemy.x\n                DataManager.Instance.enemies[index].y = enemy.y\n                DataManager.Instance.enemies[index].direction = enemy.direction\n                DataManager.Instance.enemies[index].state = enemy.state\n                DataManager.Instance.enemies[index].type = enemy.type\n            }\n\n            for (let index = 0; index < DataManager.Instance.bursts.length; index++) {\n                const burst = item.enemies[index];\n                DataManager.Instance.bursts[index].x = burst.x\n                DataManager.Instance.bursts[index].y = burst.y\n                DataManager.Instance.bursts[index].direction = burst.direction\n                DataManager.Instance.bursts[index].state = burst.state\n                DataManager.Instance.bursts[index].type = burst.type\n            }\n\n            for (let index = 0; index < DataManager.Instance.spikes.length; index++) {\n                const spike = item.spikes[index];\n                DataManager.Instance.spikes[index].x = spike.x\n                DataManager.Instance.spikes[index].y = spike.y\n                DataManager.Instance.spikes[index].count = spike.count\n                DataManager.Instance.spikes[index].type = spike.type\n            }\n        }\n    }\n}"]}