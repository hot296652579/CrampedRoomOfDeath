{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Enemy/WoodenStateMachine.ts"],"names":["_decorator","Animation","PARAMS_NAME_TYPE","IdleSubStateMachine","getParamsInitTrigger","StateMachine","ccclass","property","WoodenStateMachine","init","animationCom","addComponent","initParams","initSateMachine","addAnimationEvent","Promise","all","waitList","params","set","IDLE","stateMachine","on","EventType","FINISHED","run","currentSate","get","TURNLEFT","BLOCKFRONT","BLOCKTURNLEFT","value","BLOCKTURNRIGHT","TURNRIGHT"],"mappings":"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","sourcesContent":["import { Component, _decorator, Node, AnimationClip, Animation, SpriteFrame, SpriteAtlas } from \"cc\";\nimport { ENUM_EVENT, ENUM_BOTTOM_CONTROLLER, FSM_PARAMS_TYPE_ENUM, PARAMS_NAME_TYPE, ENITIY_TYPE_ENUM, ENTITY_STATE_ENUM } from \"../../Enum\";\nimport BlockFrontSubStateMachine from \"../Player/BlockFrontSubStateMachine\";\nimport BlockTurnLeftSubStateMachine from \"../Player/BlockTurnLeftSubStateMachine\";\nimport BlockTurnRightSubStateMachine from \"../Player/BlockTurnRightSubStateMachine\";\nimport IdleSubStateMachine from \"../Player/IdleSubStateMachine\";\nimport TurnLeftSubStateMachine from \"../Player/TurnLeftSubStateMachine\";\nimport TurnRightSubStateMachine from \"../Player/TurnRightSubStateMachine\";\n// import { DataManager.Instance } from \"../Runtime/DataManager\";\nimport { TileMapManager } from \"../TileMap/TileMapManager\";\nimport { createNewNode } from \"../Utils\";\nimport { EnitiyMgr } from \"../Base/EnitiyMgr\";\nimport { getParamsInitNumber, getParamsInitTrigger, StateMachine } from \"../Base/SateMachine\";\nimport State from \"../Base/State\";\n\n\nconst { ccclass, property } = _decorator;\n@ccclass('WoodenStateMachine')\nexport class WoodenStateMachine extends StateMachine {\n    async init() {\n        this.animationCom = this.addComponent(Animation)\n\n        this.initParams()\n        this.initSateMachine()\n        this.addAnimationEvent()\n\n        await Promise.all(this.waitList)\n    }\n\n    initParams() {\n        this.params.set(PARAMS_NAME_TYPE.IDLE, getParamsInitTrigger())\n    }\n\n    initSateMachine() {\n        this.stateMachine.set(PARAMS_NAME_TYPE.IDLE, new IdleSubStateMachine(this))\n    }\n\n    addAnimationEvent() {\n        this.animationCom.on(Animation.EventType.FINISHED, () => {\n            // const animationName = this.animationCom.defaultClip.name\n            // const list = ['block', 'turn']\n\n            // if (list.some(v => animationName.includes(v))) {\n            //     // this.setParams(PARAMS_NAME_TYPE.IDLE, true)\n            //     this.node.getComponent(EnitiyMgr).state = ENTITY_STATE_ENUM.IDLE\n            // }\n        })\n    }\n\n    run() {\n        switch (this.currentSate) {\n            case this.stateMachine.get(PARAMS_NAME_TYPE.TURNLEFT):\n            case this.stateMachine.get(PARAMS_NAME_TYPE.BLOCKFRONT):\n            case this.stateMachine.get(PARAMS_NAME_TYPE.BLOCKTURNLEFT):\n\n            case this.stateMachine.get(PARAMS_NAME_TYPE.IDLE):\n                if (this.params.get(PARAMS_NAME_TYPE.BLOCKFRONT).value) {\n                    this.currentSate = this.stateMachine.get(PARAMS_NAME_TYPE.BLOCKFRONT)\n                } else if (this.params.get(PARAMS_NAME_TYPE.BLOCKTURNRIGHT).value) {\n                    this.currentSate = this.stateMachine.get(PARAMS_NAME_TYPE.BLOCKTURNRIGHT)\n                } else if (this.params.get(PARAMS_NAME_TYPE.TURNLEFT).value) {\n                    this.currentSate = this.stateMachine.get(PARAMS_NAME_TYPE.TURNLEFT)\n                } else if (this.params.get(PARAMS_NAME_TYPE.TURNRIGHT).value) {\n                    this.currentSate = this.stateMachine.get(PARAMS_NAME_TYPE.TURNRIGHT)\n                } else if (this.params.get(PARAMS_NAME_TYPE.BLOCKTURNLEFT).value) {\n                    this.currentSate = this.stateMachine.get(PARAMS_NAME_TYPE.BLOCKTURNLEFT)\n                }\n                else if (this.params.get(PARAMS_NAME_TYPE.IDLE).value) {\n                    this.currentSate = this.stateMachine.get(PARAMS_NAME_TYPE.IDLE)\n                } else {\n                    this.currentSate = this.currentSate\n                }\n                break;\n\n            default:\n                this.currentSate = this.stateMachine.get(PARAMS_NAME_TYPE.IDLE)\n                break;\n        }\n    }\n}"]}