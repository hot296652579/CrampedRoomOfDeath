{"version":3,"sources":["file:///Users/super_javan/cocoscreator/CrampedRoomOfDeathDungeon/assets/Scripts/Enemy/Wooden/WoodenMgr.ts"],"names":["_decorator","ENTITY_STATE_ENUM","ENUM_EVENT","EnemyMgr","EventMgr","DataManager","WoodenStateMachine","MOVE_SPEED","ccclass","property","WoodenMgr","init","params","fsm","addComponent","Instance","addEventListen","ENUM_MOVE_END","checkAttack","state","DEATH","playerInfo","x","playerX","y","playerY","playerState","disX","Math","abs","disY","AIRDEATH","ATTACK","emit","ENUM_PLAYER_DEATH","IDLE","onDestroy","unEventListen"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACoBA,MAAAA,U,OAAAA,U;;AAC6CC,MAAAA,iB,iBAAAA,iB;AAAmBC,MAAAA,U,iBAAAA,U;;AAE3EC,MAAAA,Q,iBAAAA,Q;;AAEFC,MAAAA,Q;;AAEAC,MAAAA,W;;AACEC,MAAAA,kB,iBAAAA,kB;;;;;;;;;4BAEIC,U,GAAa,IAAI,E;;OAExB;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;2BAEjBU,S,WADZF,OAAO,CAAC,WAAD,C,gBAAR,MACaE,SADb;AAAA;AAAA,gCACwC;AAE1B,cAAJC,IAAI,CAACC,MAAD,EAAkB;AACxB,eAAKC,GAAL,GAAW,KAAKC,YAAL;AAAA;AAAA,uDAAX;AACA,gBAAM,KAAKD,GAAL,CAASF,IAAT,EAAN;AACA,gBAAMA,IAAN,CAAWC,MAAX;AAEA;AAAA;AAAA,oCAASG,QAAT,CAAkBC,cAAlB,CAAiC;AAAA;AAAA,wCAAWC,aAA5C,EAA2D,KAAKC,WAAhE,EAA6E,IAA7E;AACH;;AAEDA,QAAAA,WAAW,GAAG;AACV,cAAI,KAAKC,KAAL,KAAe;AAAA;AAAA,sDAAkBC,KAAjC,IAA0C,CAAC;AAAA;AAAA,0CAAYL,QAAZ,CAAqBM,UAApE,EACI;AAEJ,gBAAM;AAAEC,YAAAA,CAAC,EAAEC,OAAL;AAAcC,YAAAA,CAAC,EAAEC,OAAjB;AAA0BN,YAAAA,KAAK,EAAEO;AAAjC,cAAiD;AAAA;AAAA,0CAAYX,QAAZ,CAAqBM,UAA5E;AACA,gBAAMM,IAAI,GAAGC,IAAI,CAACC,GAAL,CAAS,KAAKP,CAAL,GAASC,OAAlB,CAAb;AACA,gBAAMO,IAAI,GAAGF,IAAI,CAACC,GAAL,CAAS,KAAKL,CAAL,GAASC,OAAlB,CAAb;AAEA,cAAIC,WAAW,IAAI;AAAA;AAAA,sDAAkBN,KAAjC,IAA0CM,WAAW,IAAI;AAAA;AAAA,sDAAkBK,QAA/E,EACI;;AAEJ,cAAK,KAAKT,CAAL,KAAWC,OAAX,IAAsBO,IAAI,IAAI,CAA/B,IAAsC,KAAKN,CAAL,KAAWC,OAAX,IAAsBE,IAAI,IAAI,CAAxE,EAA4E;AACxE,iBAAKR,KAAL,GAAa;AAAA;AAAA,wDAAkBa,MAA/B;AACA;AAAA;AAAA,sCAASjB,QAAT,CAAkBkB,IAAlB,CAAuB;AAAA;AAAA,0CAAWC,iBAAlC,EAAqD;AAAA;AAAA,wDAAkBd,KAAvE;AACH,WAHD,MAGO;AACH,iBAAKD,KAAL,GAAa;AAAA;AAAA,wDAAkBgB,IAA/B;AACH;AACJ,SA3BmC,CA6BpC;AACA;AACA;AACA;;;AAEAC,QAAAA,SAAS,GAAG;AACR,gBAAMA,SAAN;AACA;AAAA;AAAA,oCAASrB,QAAT,CAAkBsB,aAAlB,CAAgC;AAAA;AAAA,wCAAWpB,aAA3C,EAA0D,KAAKC,WAA/D;AACH;;AArCmC,O","sourcesContent":["/**木骷髅管理器 */\nimport { Component, _decorator, Node, Sprite, UITransform, Animation, SpriteAtlas, AnimationClip, animation, SpriteFrame, Texture2D, math } from \"cc\";\nimport { DIRECTION_ENUM, DIRECTION_ORDER_ENUM, ENITIY_TYPE_ENUM, ENTITY_STATE_ENUM, ENUM_EVENT, ENUM_BOTTOM_CONTROLLER, PARAMS_NAME_TYPE } from \"../../../Enum\";\nimport { IEnitiy } from \"../../../Levels\";\nimport { EnemyMgr } from \"../../Base/EnemyMgr\";\nimport { EnitiyMgr } from \"../../Base/EnitiyMgr\";\nimport EventMgr from \"../../Base/EventMgr\";\nimport { PlayerStateMachine } from \"../../Player/PlayerStateMachine\";\nimport DataManager from \"../../Runtime/DataManager\";\nimport { WoodenStateMachine } from \"./WoodenStateMachine\";\n\nexport const MOVE_SPEED = 1 / 10\n\nconst { ccclass, property } = _decorator;\n@ccclass('WoodenMgr')\nexport class WoodenMgr extends EnemyMgr {\n\n    async init(params: IEnitiy) {\n        this.fsm = this.addComponent(WoodenStateMachine)\n        await this.fsm.init()\n        super.init(params)\n\n        EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_MOVE_END, this.checkAttack, this)\n    }\n\n    checkAttack() {\n        if (this.state === ENTITY_STATE_ENUM.DEATH || !DataManager.Instance.playerInfo)\n            return\n\n        const { x: playerX, y: playerY, state: playerState } = DataManager.Instance.playerInfo\n        const disX = Math.abs(this.x - playerX)\n        const disY = Math.abs(this.y - playerY)\n\n        if (playerState == ENTITY_STATE_ENUM.DEATH || playerState == ENTITY_STATE_ENUM.AIRDEATH)\n            return\n\n        if ((this.x === playerX && disY <= 1) || (this.y === playerY && disX <= 1)) {\n            this.state = ENTITY_STATE_ENUM.ATTACK\n            EventMgr.Instance.emit(ENUM_EVENT.ENUM_PLAYER_DEATH, ENTITY_STATE_ENUM.DEATH)\n        } else {\n            this.state = ENTITY_STATE_ENUM.IDLE\n        }\n    }\n\n    // onLoad() {\n    //     super.onLoad()\n    //     EventMgr.Instance.addEventListen(ENUM_EVENT.ENUM_MOVE_END, this.checkAttack, this)\n    // }\n\n    onDestroy() {\n        super.onDestroy()\n        EventMgr.Instance.unEventListen(ENUM_EVENT.ENUM_MOVE_END, this.checkAttack)\n    }\n\n\n}"]}